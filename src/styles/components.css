/* ... keep existing code */

/* A4 Preview Styles */
.preview-container {
  width: 210mm;
  margin: 0 auto;
  background: white;
}

.a4-page {
  width: 210mm;
  min-height: 297mm;
  padding: 25mm;
  margin: 0 auto;
  background: white;
  border: 1px solid #ddd;
  position: relative;
  overflow-wrap: break-word;
  word-wrap: break-word;
}

/* Print-specific styles */
@media print {
  @page {
    size: A4;
    margin: 25mm 25mm 30mm 25mm;
    bleed: 3mm;
    marks: crop cross;
  }

  html, body {
    margin: 0;
    padding: 0;
    width: 210mm;
    height: 297mm;
    background: white;
  }

  .preview-container {
    width: 210mm;
    margin: 0;
    padding: 0;
    background: white;
  }

  .a4-page {
    margin: 0;
    border: initial;
    border-radius: initial;
    width: initial;
    min-height: initial;
    box-shadow: initial;
    background: initial;
    page-break-after: always;
  }

  /* Header styles */
  .header {
    position: running(header);
    width: 100%;
    height: 100px;
    margin-bottom: 20mm;
  }

  /* Footer styles */
  .footer {
    position: running(footer);
    bottom: 0;
    width: 100%;
    padding-top: 10mm;
    border-top: 1px solid #DAA520;
    text-align: center;
    font-size: 10pt;
    color: #666;
  }

  /* Page break controls */
  .page-break-after-avoid {
    page-break-after: avoid;
  }

  .page-break-before-always {
    page-break-before: always;
  }

  .page-break-inside-avoid {
    page-break-inside: avoid;
  }

  /* Content elements */
  img {
    max-width: 100%;
    height: auto;
    page-break-inside: avoid;
  }

  table { 
    page-break-inside: avoid;
    margin-bottom: 4mm;
  }

  tr { 
    page-break-inside: avoid;
  }

  thead { 
    display: table-header-group;
  }

  h1, h2, h3 { 
    page-break-after: avoid;
    margin-top: 6mm;
    margin-bottom: 4mm;
  }

  ul, ol { 
    page-break-inside: avoid;
    margin-bottom: 4mm;
  }

  /* Template variables */
  .template-variable {
    background-color: transparent !important;
    color: inherit !important;
  }

  /* RTL specific adjustments */
  [dir="rtl"] {
    text-align: right;
  }

  [dir="rtl"] table {
    text-align: right;
  }

  /* Watermark */
  .watermark {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) rotate(-45deg);
    font-size: 60px;
    color: rgba(218, 165, 32, 0.1);
    z-index: -1;
  }
}